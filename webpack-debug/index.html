<!DOCTYPE html><html lang="en"><head>
        <base target="_blank">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Maxime Dupr√© - Personal website">
        <title>How to debug a webpack TypeScipt server with source maps in VSC</title>
        <link rel="stylesheet" href="/styles/main.css">
        <link rel="stylesheet" href="/styles/brands.min.css">
        <link rel="stylesheet" href="/styles/fontawesome.min.css">
        <link rel="icon" type="image/webp" href="/images/favicon.webp">
    </head>
    <body>
        <nav class="bg-2 w-full h-10 flex shadow">
            <div class="container flex justify-between items-center">
                <a class="text-white" href="/" target="_self">
                    <span>Maxime Dupr√©</span></a>
                <div>
                    <a class="text-white mr-2" href="https://github.com/maximedupre"><i class="fab fa-github"></i></a>
                    <a class="text-white mr-2" href="https://twitter.com/maximehugodupre"><i class="fab fa-twitter"></i></a>
                </div>
            </div>
        </nav>
        <div class="container mt-5"><h1>How to debug a webpack TypeScipt server with source maps in VSC</h1>
<p>My <a href="kisstodo.com">KissTodo</a> <code>dev</code> script is quite the script...</p>
<pre><code class="language-json">"dev": "concurrently -k npm:build:dev-watch npm:_wait-be-dist+debug-server npm:_stripe-listen",
"build:dev-watch": "npm run build:dev -- --watch",
"build:dev": "npm run _clear-build &amp;&amp; webpack --config webpack.dev.js",
"_clear-build": "rm -rf dist",
"_wait-be-dist+debug-server": "npm run _wait-be-dist &amp;&amp; npm run _debug-server",
"_wait-be-dist": "wait-on dist/be/main.js",
"_debug-server": "nodemon --watch dist/be",
"_stripe-listen": "stripe listen --forward-to localhost:3030/api/stripe/webhook"
</code></pre>
<p>In the end, a total of 10 processes are running simultaneously, with different degrees of nesting:</p>
<p><img src="./86b887d085b15955e50e1b19d14b003295275594.png" alt="VSC debugger processes" title="VSC debugger processes" integrity="sha1-86b887d085b15955e50e1b19d14b003295275594"></p>
<p>The good thing about launching an NPM script with the VSC debugger is that the latter automatically attaches to the processes. As you can see, there is no <code>--inspect</code> flag on my <code>nodemon</code> command, VSC deals with it automatically.</p>
<p>Alright, let's get down to business. First, your <code>tsconfig.json</code> will need to generate source maps during compilation.</p>
<pre><code class="language-json">"compilerOptions": {
    "sourceMap": true
},
</code></pre>
<p>Then, you will need to add this root property to your webpack config file. It will allow webpack to take the source maps generated by TypeScript via <code>ts-loader</code> and add them to the final bundle.</p>
<pre><code class="language-javascript">devtool: 'inline-source-map',
</code></pre>
<p>Finally, the most important step: <code>.vscode/launch.json</code></p>
<pre><code class="language-json">{
    "version": "0.2.0",
    "configurations": [
        {
            "type": "node",
            "request": "launch",
            "name": "Debug",
            "runtimeExecutable": "npm",
            "runtimeArgs": ["run-script", "dev"],
            "skipFiles": ["&lt;node_internals&gt;/**"],
            "envFile": "${workspaceFolder}/.env",
            "sourceMapPathOverrides": {
                "webpack:///./~/*": "${workspaceRoot}/node_modules/*",
                "webpack:///./*": "${workspaceRoot}/*",
                "webpack:///*": "*"
            }
        }
    ]
}
</code></pre>
<p>Everything in there is pretty simple and normal. The key part is the <code>sourceMapPathOverrides</code> property if you want to be able to debug your local file and not webpack's internal version of your files. See, since webpack is compiling the <code>.ts</code> files via the <code>ts-loader</code>, the source maps will reference webpack's internal version of your <code>.ts</code> files and not your local <code>.ts</code> files.</p>
<p>Then start your debug config...</p>
<p><img src="./af2f576e1b3bce07a05fc9469482315e60bfca11.png" alt="VSC debugger unbound breakpoint" title="VSC debugger unbound breakpoint" integrity="sha1-af2f576e1b3bce07a05fc9469482315e60bfca11"></p>
<p>The breakpoints will be unbound until VSC starts executing files with source maps that point to the <code>webpack://</code> versions of your files, which VSC will resolve to your local files and...</p>
<p><img src="./118ce108d459d4721e8c11e63b3cf71ca42cb7ee.png" alt="VSC debugger bound breakpoint" title="VSC debugger bound breakpoint" integrity="sha1-118ce108d459d4721e8c11e63b3cf71ca42cb7ee"></p>
<p>TADA ‚≠êÔ∏è</p>
<p>Hope this helps üí™</p>
<h3>Want to leave a comment?</h3>
<p>Join the discussion at <a href="https://twitter.com/maximehugodupre/status/1424783409205940224">Twitter</a>. Feel free to drop me an <a href="mailto:maximedupre@me.com">email</a>. üíå</p>
</div>
    

</body></html>